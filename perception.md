# Perception

## Segmentation

### Overview

When accessing the WebUI on the Maivin configuration, there is a Segmentation view. The Segmentation view will draw masks detected by the model running on the Maivin. Different classes of the segmentation masks will have different colors.

### Accessing

On the home page of the WebUI in Maivin configuration, users can click the "Segmentation" card. Alternatively, on both Maivin and Raivin configurations, users can directly access the webpage at `https://hostname/segmentation`

### Configuration

The segmentation can be configured using the WebUI settings. The specific settings that affect the Segmentation view are:

| Setting Name  | Description                                                                                                                                                |
| ------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Mirror Inputs | Flips the camera and mask in the left right direction.                                                                                                    |
| Mask topic    | Sets the topic to recieve mask messages from.<br />Recommended to use mask_compressed to reduce network bandwidth requirements.                            |
| PCD topic     | Sets the topic to recieve camera messages from.                                                                                                            |
| Show Stats    | Shows the FPS for the camera and model.                                                                                                                    |
| Draw Box      | Shows boxes from the model.                                                                                                                                |
| Draw Box Text | Shows the text label of the box.<br />The text is the box's track_id if present, otherwise it will be the box's label as configured in the Detect service. |

## Occupancy Grid

### Overview

When access the WebUI on the Raivin configuration, there is an Occupancy Grid view. The Occupancy Grid will draw a polar grid to assist users in visualizing the grid. Additionally, the Occupancy grid can visualize radar points on the grid and color the radar points based on it's properties, such as speed, rcs, class.

### Accessing

On the home page of the WebUI in Raivin configuration, users can click the "Occupancy Grid" card. Alternatively, on Raivin configurations, users can directly access the webpage at `https://hostname/grid`. This view does not work on Maivin configurations.

### Configuration

The Occupancy Grid can be configured using the WebUI settings. The specific settings that affect the Occuancy Grid view are:

| Setting Name         | Description                                                                                                                                                                                                                                                                                                                                                        |
| -------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Mirror Inputs        | Flips the grid and radar points in the left right direction.                                                                                                                                                                                                                                                                                                      |
| Angle Bin Width      | The anglular width of each cell on the polar grid.                                                                                                                                                                                                                                                                                                                 |
| Angle Bin Limits Min | The minimum angle of the polar grid.                                                                                                                                                                                                                                                                                                                               |
| Angle Bin Limits Max | The maximum angle of the polar grid.                                                                                                                                                                                                                                                                                                                               |
| Range Bin Width      | The range width of each cell on the polar grid.                                                                                                                                                                                                                                                                                                                    |
| Range Bin Limits Min | The minimum range of the polar grid. Must be greater than 0.                                                                                                                                                                                                                                                                                                       |
| Range Bin Limits Max | The maximum range of the polar grid.                                                                                                                                                                                                                                                                                                                               |
| Window Length        | The last `window length` radar PCD messages will be combined and used to determine if a cell has enough points to be considered occupied.                                                                                                                                                                                                                        |
| Bin Threshold        | If the cell has `bin threshold` points or more inside it, it will be considered occupied.                                                                                                                                                                                                                                                                        |
| Grid Draw PCD        | Draw PCD on the grid and color the points based on the given parameter.<br />For `disabled`, no points will be drawn.<br />For `class`, the points will be colored by class using visually distinct colors. <br />For all other parameters, the points will be colored by a gradient, moving from Red (min value) to White (mean value) to Blue (max value))) |
| PCD topic            | Sets the topic to recieve radar PCD messages from.                                                                                                                                                                                                                                                                                                                 |
| Draw Cells           | Draws cells occupied by radar points.<br />If this is disabled, the Draw Unknown Cells will also be disabled.                                                                                                                                                                                                                                                     |
| Draw Unknown Cells   | Draws cells occupied by unknown radar points                                                                                                                                                                                                                                                                                                                       |
| Show Stats           | Shows the FPS for the camera and model.                                                                                                                                                                                                                                                                                                                            |
| Show People Count    | Shows the number of people being seen by the system.                                                                                                                                                                                                                                                                                                               |

## Segmentation + Occupancy Grid

### Overview

When access the WebUI on the Raivin configuration, there is a combined Segmentation + Occupancy Grid view. The combined view is split horizontally into two halves. The top half draws a segmentation view. The bottom half draws an occupancy grid view.

### Accessing

On the home page of the WebUI in Raivin configuration, users can click the "Segmentation View" card. Alternatively, on Raivin configurations, users can directly access the webpage at `https://hostname/combined`. This view does not work on Maivin configurations.

### Configuration

The combined view can be configured using the WebUI settings. The specific settings that affect the combined view are:

| Setting Name              | Description                                                                                                                                                                                                                                                                                                                                                                           |
| ------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Mirror Inputs             | Flips the grid and radar points in the left right direction.                                                                                                                                                                                                                                                                                                                         |
| Angle Bin Width           | The anglular width of each cell on the polar grid.                                                                                                                                                                                                                                                                                                                                    |
| Angle Bin Limits Min      | The minimum angle of the polar grid.                                                                                                                                                                                                                                                                                                                                                  |
| Angle Bin Limits Max      | The maximum angle of the polar grid.                                                                                                                                                                                                                                                                                                                                                  |
| Range Bin Width           | The range width of each cell on the polar grid.                                                                                                                                                                                                                                                                                                                                       |
| Range Bin Limits Min      | The minimum range of the polar grid. Must be greater than 0.                                                                                                                                                                                                                                                                                                                          |
| Range Bin Limits Max      | The maximum range of the polar grid.                                                                                                                                                                                                                                                                                                                                                  |
| Window Length             | The last `window length` radar PCD messages will be combined and used to determine if a cell has enough points to be considered occupied.                                                                                                                                                                                                                                           |
| Bin Threshold             | If the cell has `bin threshold` points or more inside it, it will be considered occupied.                                                                                                                                                                                                                                                                                           |
| Combined Grid Draw PCD    | Draw PCD on the grid and color the points based on the given parameter.<br />For `disabled`, no points will be drawn.<br />For `class`, the points will be colored by class using visually distinct colors. <br />For all other parameters, the points will be colored by a gradient, moving from Red (min value) to White (mean value) to Blue (max value)))                    |
| Combined Camera Draw PCD  | Projects the PCD onto the camera view and color the points based on the given parameter.<br />For `disabled`, no points will be drawn.<br />For `class`, the points will be colored by class using visually distinct colors. <br />For all other parameters, the points will be colored by a gradient, moving from Red (min value) to White (mean value) to Blue (max value))) |
| Combined Camera PCD Label | Projects the PCD onto the camera view and adds a text label of the given parameters.<br />For `disabled`, no text label is added.<br />For all other parameters, the numeric value is shown.                                                                                                                                                                                        |
| PCD topic                 | Sets the topic to recieve radar PCD messages from.                                                                                                                                                                                                                                                                                                                                    |
| Draw Cells                | Draws cells occupied by radar points.<br />If this is disabled, the Draw Unknown Cells will also be disabled.                                                                                                                                                                                                                                                                        |
| Draw Unknown Cells        | Draws cells occupied by unknown radar points                                                                                                                                                                                                                                                                                                                                          |
| Draw Box                  | Shows boxes from the model.                                                                                                                                                                                                                                                                                                                                                           |
| Draw Box Text             | Shows the text label of the box.<br />The radar PCD will be projected onto the boxes, and for each box, the point closest to the camera that is enclosed by the box will have its range and speed used for the label.                                                                                                                                                               |
| Show Stats                | Shows the FPS for the camera and model.                                                                                                                                                                                                                                                                                                                                               |
| Show People Count         | Shows the number of people being seen by the system.                                                                                                                                                                                                                                                                                                                                  |
